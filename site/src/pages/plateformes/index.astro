---
import '@/styles/global.css';
import BaseLayout from '@/layouts/BaseLayout.astro';
import Navbar from '@/components/Navbar.astro';
import Footer from '@/components/Footer.astro';
import { getExchangesSortedByScore } from '@/data/exchange-reviews';

const year = new Date().getFullYear();
const month = new Date().toLocaleDateString('fr-FR', { month: 'long', year: 'numeric' });
const exchanges = getExchangesSortedByScore();
---

<BaseLayout
  title={`Meilleures plateformes crypto ${year} : Comparatif et avis | CryptoSous`}
  description={`Classement des meilleures plateformes crypto en ${year}. Comparatif détaillé des frais, sécurité et fonctionnalités de Binance, Coinbase, Kraken, Bybit, Bitpanda et Crypto.com.`}
>
  <Navbar />

  <main class="pt-32 pb-16">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Breadcrumb -->
      <nav class="flex items-center gap-2 text-sm text-text-muted mb-8" aria-label="Fil d'ariane">
        <a href="/" class="hover:text-gold transition-colors cursor-pointer">Accueil</a>
        <span>/</span>
        <span class="text-text-secondary">Plateformes</span>
      </nav>

      <!-- Hero -->
      <div class="mb-12">
        <h1 class="font-display font-800 text-display leading-[1.1] mb-4 tracking-tight">
          Meilleures <span class="text-gradient-gold">plateformes crypto</span> {year}
        </h1>
        <p class="text-body-lg text-text-secondary max-w-2xl">
          Notre classement indépendant des meilleurs exchanges crypto pour les investisseurs francophones. Frais, sécurité, cryptos disponibles et facilité d'utilisation comparés.
        </p>
        <div class="mt-3">
          <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs border border-border text-text-muted">
            <span class="w-1.5 h-1.5 rounded-full bg-positive animate-pulse"></span>
            Mis à jour en {month}
          </span>
        </div>
      </div>

      <!-- Ranking Table -->
      <div class="mb-12 overflow-x-auto">
        <table class="w-full text-sm border-collapse">
          <thead>
            <tr class="border-b border-border">
              <th class="text-left py-3 px-3 text-text-muted font-medium text-xs uppercase tracking-wider">#</th>
              <th class="text-left py-3 px-3 text-text-muted font-medium text-xs uppercase tracking-wider">Plateforme</th>
              <th class="text-center py-3 px-3 text-text-muted font-medium text-xs uppercase tracking-wider">Score</th>
              <th class="text-center py-3 px-3 text-text-muted font-medium text-xs uppercase tracking-wider">Frais maker</th>
              <th class="text-center py-3 px-3 text-text-muted font-medium text-xs uppercase tracking-wider">Cryptos</th>
              <th class="text-center py-3 px-3 text-text-muted font-medium text-xs uppercase tracking-wider">Staking</th>
              <th class="text-right py-3 px-3"></th>
            </tr>
          </thead>
          <tbody>
            {exchanges.map((ex, i) => (
              <tr class="border-b border-border/50 hover:bg-surface-hover/30 transition-colors">
                <td class="py-4 px-3">
                  <span class={`font-display font-700 text-sm ${i === 0 ? 'text-gold' : 'text-text-muted'}`}>{i + 1}</span>
                </td>
                <td class="py-4 px-3">
                  <a href={`/plateformes/${ex.slug}`} class="font-display font-600 text-text-primary hover:text-gold transition-colors cursor-pointer">
                    {ex.name}
                  </a>
                  <p class="text-xs text-text-muted mt-0.5 hidden sm:block">{ex.headquarters}</p>
                </td>
                <td class="py-4 px-3 text-center">
                  <span class="inline-flex items-center justify-center w-10 h-10 rounded-lg bg-gold/10 border border-gold/20">
                    <span class="font-display font-700 text-sm text-gold">{ex.overallScore}</span>
                  </span>
                </td>
                <td class="py-4 px-3 text-center font-mono text-text-primary">{ex.fees.spotMaker}%</td>
                <td class="py-4 px-3 text-center font-mono text-text-primary">{ex.cryptosCount}+</td>
                <td class="py-4 px-3 text-center">
                  {ex.hasStaking
                    ? <span class="text-positive text-xs font-semibold">Oui</span>
                    : <span class="text-text-muted text-xs">Non</span>
                  }
                </td>
                <td class="py-4 px-3 text-right">
                  <a
                    href={`/plateformes/${ex.slug}`}
                    class="inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium bg-gold/10 text-gold border border-gold/20 rounded-lg hover:bg-gold/20 transition-colors cursor-pointer"
                  >
                    Lire l'avis
                  </a>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>

      <!-- SEO Text -->
      <section class="mb-12">
        <h2 class="font-display font-700 text-h2 mb-4">Comment choisir sa plateforme crypto ?</h2>
        <div class="text-text-secondary leading-relaxed space-y-4">
          <p>
            Le choix d'une plateforme d'échange crypto dépend de votre profil d'investisseur. Un débutant privilégiera la simplicité d'utilisation (Coinbase, Bitpanda), tandis qu'un trader actif cherchera les frais les plus bas (Binance, Bybit). Pour les investisseurs soucieux de la sécurité, Kraken et sa réputation sans faille depuis 2011 est un choix de confiance.
          </p>
          <p>
            Tous les exchanges de notre classement sont accessibles aux résidents français et supportent les dépôts en euros par virement SEPA. Nous évaluons chaque plateforme selon 5 critères : frais de trading, sécurité et régulation, facilité d'utilisation, nombre de cryptos disponibles, et qualité du support client.
          </p>
          <p>
            Important : diversifiez vos plateformes si vous investissez des montants significatifs. Et pour le stockage long terme, considérez un <a href="/wallets" class="text-gold hover:underline">hardware wallet</a> plutôt que de laisser vos cryptos sur un exchange.
          </p>
        </div>
      </section>

      <!-- Cross-linking -->
      <section class="mb-12">
        <h2 class="font-display font-700 text-h2 mb-6">Ressources complémentaires</h2>
        <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
          <a href="/wallets" class="flex flex-col items-center gap-2 p-4 rounded-xl border border-border bg-surface-raised/30 hover:border-gold/50 hover:bg-surface-hover transition-all cursor-pointer group text-center">
            <span class="text-sm font-medium text-text-primary group-hover:text-gold transition-colors">Wallets crypto</span>
            <span class="text-xs text-text-muted">Hardware wallets</span>
          </a>
          <a href="/comparer" class="flex flex-col items-center gap-2 p-4 rounded-xl border border-border bg-surface-raised/30 hover:border-gold/50 hover:bg-surface-hover transition-all cursor-pointer group text-center">
            <span class="text-sm font-medium text-text-primary group-hover:text-gold transition-colors">Comparer les cryptos</span>
            <span class="text-xs text-text-muted">105 comparaisons</span>
          </a>
          <a href="/outils" class="flex flex-col items-center gap-2 p-4 rounded-xl border border-border bg-surface-raised/30 hover:border-gold/50 hover:bg-surface-hover transition-all cursor-pointer group text-center">
            <span class="text-sm font-medium text-text-primary group-hover:text-gold transition-colors">Outils crypto</span>
            <span class="text-xs text-text-muted">Convertisseur, DCA...</span>
          </a>
        </div>
      </section>

      <!-- Disclaimer -->
      <div class="p-5 rounded-card border border-border bg-surface/50 text-xs text-text-muted leading-relaxed">
        <strong class="text-text-secondary">Avertissement :</strong> Les cryptomonnaies sont des actifs volatils. Investir comporte des risques de perte en capital. Ce classement ne constitue pas un conseil en investissement. Certains liens sont des liens d'affiliation. Faites vos propres recherches (DYOR).
      </div>
    </div>
  </main>

  <Footer />

  <!-- Schema.org BreadcrumbList -->
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      { "@type": "ListItem", "position": 1, "name": "Accueil", "item": "https://cryptosous.fr/" },
      { "@type": "ListItem", "position": 2, "name": "Plateformes" },
    ],
  })} />
</BaseLayout>
